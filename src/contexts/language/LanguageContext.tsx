import React, { createContext, useContext, useState, useEffect } from 'react';

type LanguageContextType = {
  language: 'ar' | 'fr' | 'en';
  setLanguage: (lang: 'ar' | 'fr' | 'en') => void;
  t: (key: string) => string;
  dir: 'rtl' | 'ltr';
};

const translations = {
  ar: {
    'site.name': 'Osken',
    'nav.home': 'الرئيسية',
    'nav.explore': 'استكشاف',
    'nav.sale': 'للبيع',
    'nav.rent': 'للإيجار',
    'nav.map': 'الخريطة',
    'nav.search': 'بحث',
    'nav.signin': 'تسجيل الدخول',
    'nav.signup': 'إنشاء حساب',
    'nav.profile': 'الملف الشخصي',
    'nav.favorites': 'المفضلة',
    'nav.logout': 'تسجيل الخروج',
    
    'hero.title': 'ابحث عن مساحتك المثالية',
    'hero.subtitle': 'اكتشف آلاف العقارات للبيع والإيجار',
    'hero.search': 'ابحث عن عقارات',
    'hero.list': 'أضف عقارك',
    'hero.browse': 'تصفح العقارات',
    
    'featured.title': 'عقارات مميزة',
    'featured.viewAll': 'عرض الكل',
    
    'luxury.title': 'عقارات فاخرة',
    'luxury.viewAll': 'عرض الكل',
    'luxury.badge': 'فاخر',
    
    'cta.title': 'هل أنت مستعد للعثور على منزل أحلامك؟',
    'cta.subtitle': 'دعنا نساعدك في العثور على المكان المثالي لك ولعائلتك',
    'cta.search': 'ابحث عن العقارات',
    'cta.contact': 'تواصل معنا',
    
    'property.beds': 'غرف',
    'property.save': 'حفظ',
    'property.share': 'مشاركة',
    'property.built': 'بني عام',
    'property.details': 'تفاصيل العقار',
    'property.features': 'المميزات والمرافق',
    'property.additionalInfo': 'معلومات إضافية',
    'property.contactAgent': 'تواصل مع الوكيل',
    'property.contactPlaceholder': 'أنا مهتم بهذا العقار وأود تحديد موعد لمشاهدته.',
    'property.contactDisclaimer': 'سيتم مشاركة معلومات الاتصال الخاصة بك مع الوكيل',
    'property.notFound': 'العقار غير موجود',
    'property.notFoundDescription': 'العقار الذي تبحث عنه غير موجود أو تمت إزالته.',
    'property.savedTitle': 'تم حفظ العقار',
    'property.savedDescription': 'تمت إضافة هذا العقار إلى المفضلة.',
    'property.shareTitle': 'تم نسخ رابط المشاركة',
    'property.shareDescription': 'تم نسخ رابط العقار إلى الحافظة.',
    'property.contactTitle': 'تم إرسال الرسالة',
    'property.contactDescription': 'تم إرسال رسالتك إلى مالك العقار.',
    'account.myAccount': 'حسابي',
    'signin.title': 'تسجيل الدخول',
    'signin.subtitle': 'أدخل بريدك الإلكتروني وكلمة المرور لتسجيل الدخول',
    'signin.email': 'البريد الإلكتروني',
    'signin.password': 'كلمة المرور',
    'signin.button': 'تسجيل الدخول',
    'signin.noAccount': 'ليس لديك حساب؟',
    'signin.create': 'إنشاء حساب',
    'signup.title': 'إنشاء حساب',
    'signup.subtitle': 'أدخل معلوماتك لإنشاء حساب',
    'signup.emailAlert': 'سيتم إرسال بريد إلكتروني للتأكيد لتحقق من حسابك. يرجى التحقق من صندوق الوارد الخاص بك بعد التسجيل.',
    'signup.note': 'ملاحظة',
    'signup.algerianNumbersNote': 'قد لا تتلقى الأرقام الجزائرية رموز SMS فعلية بسبب قيود Twilio. ستتمكن من المتابعة في وضع العرض التوضيحي.',
    'signup.emailTab': 'البريد الإلكتروني',
    'signup.phoneTab': 'الهاتف',
    'signup.alreadyHaveAccount': 'لديك حساب بالفعل؟',
    'notifications.title': 'الإشعارات',
    'notifications.markAllRead': 'تعليم الكل كمقروء',
    'notifications.noNotifications': 'لا توجد إشعارات حتى الآن',
    'notifications.newProperty': 'عقار جديد معروض',
    'notifications.propertyMatch': 'عقار جديد يطابق معاييرك',
    'notifications.priceAlert': 'تنبيه انخفاض السعر',
    'notFound.title': 'عذراً! الصفحة غير موجودة',
    'notFound.returnHome': 'العودة إلى الصفحة الرئيسية',
    'otp.title': 'أدخل رمز التحقق',
    'otp.subtitle': 'تم إرسال رمز التحقق إلى',
    'otp.demoSubtitle': 'أدخل أي 6 أرقام للمتابعة في وضع العرض التوضيحي',
    'otp.verify': 'تحقق وإنشاء الحساب',
    'otp.back': 'رجوع',
    'demo.title': 'وضع العرض التوضيحي مفعل',
    'demo.description': 'لا يمكن معالجة التحقق من هاتفك بواسطة مزود الرسائل القصيرة. يمكنك المتابعة في وضع العرض التوضيحي حيث سيعمل أي رمز مكون من 6 أرقام.',
    'phone.label': 'رقم الهاتف',
    'phone.placeholder': '123456789',
    'phone.subtitle': 'أدخل رقم هاتفك بدون رمز البلد',
    'phone.send': 'إرسال رمز التحقق',
    'phone.sending': 'جاري إرسال الرمز...',
    'role.label': 'أنا',
    'role.subtitle': 'حدد دورك في المنصة',
    'role.buyer': 'مشتري',
    'role.seller': 'بائع',
    'role.agent': 'وكيل',
    'name.label': 'الاسم الكامل',
    'name.placeholder': 'اسمك',
    'email.label': 'البريد الإلكتروني',
    'email.placeholder': 'بريدك@الإلكتروني.com',
    'password.label': 'كلمة المرور',
    'password.placeholder': '••••••••',
    'password.requirement': 'يجب أن تتكون كلمة المرور من 6 أحرف على الأقل',
    'signup.button': 'إنشاء حساب',
    'signup.creating': 'جاري إنشاء الحساب...',
    'signup.emailSent': 'تم إرسال بريد التأكيد',
    'signup.demoActive': 'وضع العرض التوضيحي مفعل',
    
    // Search page translations
    'search.placeholder': 'ابحث حسب الموقع أو اسم العقار',
    'search.showFilters': 'إظهار الفلاتر',
    'search.hideFilters': 'إخفاء الفلاتر',
    'search.propertyType': 'نوع العقار',
    'search.anyPropertyType': 'أي نوع عقار',
    'search.villa': 'فيلا',
    'search.apartment': 'شقة',
    'search.studio': 'استوديو',
    'search.duplex': 'دوبلكس',
    'search.traditionalHouse': 'منزل تقليدي',
    'search.loft': 'لوفت',
    'search.chalet': 'شاليه',
    'search.city': 'المدينة',
    'search.anyCity': 'أي مدينة',
    'search.priceRange': 'نطاق السعر (دج)',
    'search.minimumBedrooms': 'الحد الأدنى لعدد غرف النوم',
    'search.any': 'أي',
    'search.features': 'المميزات',
    'search.parking': 'موقف سيارات',
    'search.furnished': 'مفروش',
    'search.pool': 'مسبح',
    'search.garden': 'حديقة',
    'search.security': 'أمن',
    'search.petFriendly': 'يسمح بالحيوانات الأليفة',
    'search.propertiesFound': 'عقارات تم العثور عليها',
    'search.noPropertiesFound': 'لم يتم العثور على عقارات',
    'search.adjustSearchCriteria': 'حاول تعديل معايير البحث للعثور على المزيد من العقارات.',
    'search.resetFilters': 'إعادة تعيين الفلاتر',
    'role.placeholder': 'اختر دورك',
    'otp.verifying': 'جاري التحقق...',
    
    // Hero section translations
    'search.location': 'الموقع، اسم العقار، أو كلمة مفتاحية',
    'search.search': 'بحث',
    'hero.browse': 'تصفح العقارات',
  },
  fr: {
    'site.name': 'Osken',
    'nav.home': 'Accueil',
    'nav.explore': 'Explorer',
    'nav.sale': 'À Vendre',
    'nav.rent': 'À Louer',
    'nav.map': 'Carte',
    'nav.search': 'Rechercher',
    'nav.signin': 'Se Connecter',
    'nav.signup': 'S\'inscrire',
    'nav.profile': 'Profil',
    'nav.favorites': 'Favoris',
    'nav.logout': 'Se Déconnecter',
    
    'hero.title': 'Trouvez Votre Espace Idéal',
    'hero.subtitle': 'Découvrez des milliers de propriétés à vendre et à louer',
    'hero.search': 'Rechercher des Propriétés',
    'hero.list': 'Lister Votre Propriété',
    'hero.browse': 'Parcourir les propriétés',
    
    'featured.title': 'Propriétés en Vedette',
    'featured.viewAll': 'Voir Tout',
    
    'luxury.title': 'Propriétés de Luxe',
    'luxury.viewAll': 'Voir Tout',
    'luxury.badge': 'Luxe',
    
    'cta.title': 'Prêt à trouver votre maison de rêve?',
    'cta.subtitle': 'Laissez-nous vous aider à trouver l\'endroit parfait pour vous et votre famille',
    'cta.search': 'Rechercher des propriétés',
    'cta.contact': 'Contactez-nous',
    
    'property.beds': 'chambres',
    'property.save': 'Sauvegarder',
    'property.share': 'Partager',
    'property.built': 'Construit en',
    'property.details': 'Détails de la Propriété',
    'property.features': 'Caractéristiques et Commodités',
    'property.additionalInfo': 'Informations Supplémentaires',
    'property.contactAgent': 'Contacter l\'Agent',
    'property.contactPlaceholder': 'Je suis intéressé par cette propriété et j\'aimerais planifier une visite.',
    'property.contactDisclaimer': 'Vos informations de contact seront partagées avec l\'agent',
    'property.notFound': 'Propriété Non Trouvée',
    'property.notFoundDescription': 'La propriété que vous cherchez n\'existe pas ou a été supprimée.',
    'property.savedTitle': 'Propriété Sauvegardée',
    'property.savedDescription': 'Cette propriété a été ajoutée à vos favoris.',
    'property.shareTitle': 'Lien de Partage Copié',
    'property.shareDescription': 'Le lien de la propriété a été copié dans votre presse-papiers.',
    'property.contactTitle': 'Message Envoyé',
    'property.contactDescription': 'Votre message a été envoyé au propriétaire.',
    'account.myAccount': 'Mon Compte',
    'signin.title': 'Se Connecter',
    'signin.subtitle': 'Entrez votre email et mot de passe pour vous connecter',
    'signin.email': 'Email',
    'signin.password': 'Mot de passe',
    'signin.button': 'Se Connecter',
    'signin.noAccount': 'Vous n\'avez pas de compte?',
    'signin.create': 'Créer un compte',
    'signup.title': 'Créer un Compte',
    'signup.subtitle': 'Entrez vos informations pour créer un compte',
    'signup.emailAlert': 'Un email de confirmation sera envoyé pour vérifier votre compte. Veuillez vérifier votre boîte de réception après l\'inscription.',
    'signup.note': 'Remarque',
    'signup.algerianNumbersNote': 'Les numéros algériens peuvent ne pas recevoir de codes SMS réels en raison des restrictions de Twilio. Vous pourrez continuer en mode démo.',
    'signup.emailTab': 'Email',
    'signup.phoneTab': 'Téléphone',
    'signup.alreadyHaveAccount': 'Vous avez déjà un compte?',
    'notifications.title': 'Notifications',
    'notifications.markAllRead': 'Marquer tout comme lu',
    'notifications.noNotifications': 'Pas encore de notifications',
    'notifications.newProperty': 'Nouvelle Propriété Listée',
    'notifications.propertyMatch': 'Une nouvelle propriété correspondant à vos critères a été listée',
    'notifications.priceAlert': 'Alerte de Baisse de Prix',
    'notFound.title': 'Oops! Page non trouvée',
    'notFound.returnHome': 'Retourner à l\'Accueil',
    'otp.title': 'Entrez le code de vérification',
    'otp.subtitle': 'Un code de vérification a été envoyé à',
    'otp.demoSubtitle': 'Entrez n\'importe quels 6 chiffres pour continuer en mode démo',
    'otp.verify': 'Vérifier et Créer un Compte',
    'otp.back': 'Retour',
    'demo.title': 'Mode Démo Activé',
    'demo.description': 'Votre vérification téléphonique n\'a pas pu être traitée par notre fournisseur de SMS. Vous pouvez continuer en mode démo où n\'importe quel code à 6 chiffres fonctionnera.',
    'phone.label': 'Numéro de Téléphone',
    'phone.placeholder': '123456789',
    'phone.subtitle': 'Entrez votre numéro de téléphone sans l\'indicatif du pays',
    'phone.send': 'Envoyer le Code de Vérification',
    'phone.sending': 'Envoi du code...',
    'role.label': 'Je suis un',
    'role.subtitle': 'Sélectionnez votre rôle sur la plateforme',
    'role.buyer': 'Acheteur',
    'role.seller': 'Vendeur',
    'role.agent': 'Agent',
    'name.label': 'Nom Complet',
    'name.placeholder': 'Votre nom',
    'email.label': 'Email',
    'email.placeholder': 'votre@email.com',
    'password.label': 'Mot de passe',
    'password.placeholder': '••••••••',
    'password.requirement': 'Le mot de passe doit comporter au moins 6 caractères',
    'signup.button': 'Créer un Compte',
    'signup.creating': 'Création du compte...',
    'signup.emailSent': 'Email de Confirmation Envoyé',
    'signup.demoActive': 'Mode Démo Actif',
    
    // Search page translations
    'search.placeholder': 'Rechercher par emplacement ou nom de propriété',
    'search.showFilters': 'Afficher les filtres',
    'search.hideFilters': 'Masquer les filtres',
    'search.propertyType': 'Type de propriété',
    'search.anyPropertyType': 'Tout type de propriété',
    'search.villa': 'Villa',
    'search.apartment': 'Appartement',
    'search.studio': 'Studio',
    'search.duplex': 'Duplex',
    'search.traditionalHouse': 'Maison Traditionnelle',
    'search.loft': 'Loft',
    'search.chalet': 'Chalet',
    'search.city': 'Ville',
    'search.anyCity': 'Toutes les villes',
    'search.priceRange': 'Fourchette de prix (DZD)',
    'search.minimumBedrooms': 'Chambres minimum',
    'search.any': 'Toutes',
    'search.features': 'Caractéristiques',
    'search.parking': 'Parking',
    'search.furnished': 'Meublé',
    'search.pool': 'Piscine',
    'search.garden': 'Jardin',
    'search.security': 'Sécurité',
    'search.petFriendly': 'Animaux acceptés',
    'search.propertiesFound': 'Propriétés trouvées',
    'search.noPropertiesFound': 'Aucune propriété trouvée',
    'search.adjustSearchCriteria': 'Essayez d\'ajuster vos critères de recherche pour trouver plus de propriétés.',
    'search.resetFilters': 'Réinitialiser les filtres',
    'role.placeholder': 'Sélectionnez votre rôle',
    'otp.verifying': 'Vérification en cours...',
    
    // Hero section translations
    'search.location': 'Lieu, nom de propriété, ou mot-clé',
    'search.search': 'Rechercher',
    'hero.browse': 'Parcourir les propriétés',
  },
  en: {
    'site.name': 'Osken',
    'nav.home': 'Home',
    'nav.explore': 'Explore',
    'nav.sale': 'For Sale',
    'nav.rent': 'For Rent',
    'nav.map': 'Map',
    'nav.search': 'Search',
    'nav.signin': 'Sign In',
    'nav.signup': 'Sign Up',
    'nav.profile': 'Profile',
    'nav.favorites': 'Favorites',
    'nav.logout': 'Log Out',
    
    'hero.title': 'Find Your Ideal Space',
    'hero.subtitle': 'Discover thousands of properties for sale and rent',
    'hero.search': 'Search Properties',
    'hero.list': 'List Your Property',
    'hero.browse': 'Browse Properties',
    
    'featured.title': 'Featured Properties',
    'featured.viewAll': 'View All',
    
    'luxury.title': 'Luxury Properties',
    'luxury.viewAll': 'View All',
    'luxury.badge': 'Luxury',
    
    'cta.title': 'Ready to find your dream home?',
    'cta.subtitle': 'Let us help you find the perfect place for you and your family',
    'cta.search': 'Search Properties',
    'cta.contact': 'Contact Us',
    
    'property.beds': 'beds',
    'property.save': 'Save',
    'property.share': 'Share',
    'property.built': 'Built',
    'property.details': 'Property Details',
    'property.features': 'Features & Amenities',
    'property.additionalInfo': 'Additional Information',
    'property.contactAgent': 'Contact Agent',
    'property.contactPlaceholder': 'I\'m interested in this property and would like to schedule a viewing.',
    'property.contactDisclaimer': 'Your contact information will be shared with the agent',
    'property.notFound': 'Property Not Found',
    'property.notFoundDescription': 'The property you\'re looking for doesn\'t exist or has been removed.',
    'property.savedTitle': 'Property Saved',
    'property.savedDescription': 'This property has been added to your favorites.',
    'property.shareTitle': 'Share Link Copied',
    'property.shareDescription': 'Property link has been copied to your clipboard.',
    'property.contactTitle': 'Message Sent',
    'property.contactDescription': 'Your message has been sent to the property owner.',
    'account.myAccount': 'My Account',
    'signin.title': 'Sign In',
    'signin.subtitle': 'Enter your email and password to sign in',
    'signin.email': 'Email',
    'signin.password': 'Password',
    'signin.button': 'Sign In',
    'signin.noAccount': 'Don\'t have an account?',
    'signin.create': 'Create account',
    'signup.title': 'Create an Account',
    'signup.subtitle': 'Enter your information to create an account',
    'signup.emailAlert': 'A confirmation email will be sent to verify your account. Please check your inbox after signing up.',
    'signup.note': 'Note',
    'signup.algerianNumbersNote': 'Algerian numbers may not receive actual SMS codes due to Twilio restrictions. You\'ll be able to continue in demo mode.',
    'signup.emailTab': 'Email',
    'signup.phoneTab': 'Phone',
    'signup.alreadyHaveAccount': 'Already have an account?',
    'notifications.title': 'Notifications',
    'notifications.markAllRead': 'Mark all as read',
    'notifications.noNotifications': 'No notifications yet',
    'notifications.newProperty': 'New Property Listed',
    'notifications.propertyMatch': 'A new property matching your criteria has been listed',
    'notifications.priceAlert': 'Price Drop Alert',
    'notFound.title': 'Oops! Page not found',
    'notFound.returnHome': 'Return to Home',
    'otp.title': 'Enter verification code',
    'otp.subtitle': 'A verification code has been sent to',
    'otp.demoSubtitle': 'Enter any 6 digits to continue in demo mode',
    'otp.verify': 'Verify & Create Account',
    'otp.back': 'Back',
    'demo.title': 'Demo Mode Active',
    'demo.description': 'Your phone verification couldn\'t be processed by our SMS provider. You can continue in demo mode where any 6-digit code will work.',
    'phone.label': 'Phone Number',
    'phone.placeholder': '123456789',
    'phone.subtitle': 'Enter your phone number without the country code',
    'phone.send': 'Send Verification Code',
    'phone.sending': 'Sending code...',
    'role.label': 'I am a',
    'role.subtitle': 'Select your role in the platform',
    'role.buyer': 'Buyer',
    'role.seller': 'Seller',
    'role.agent': 'Agent',
    'name.label': 'Full Name',
    'name.placeholder': 'Your name',
    'email.label': 'Email',
    'email.placeholder': 'your@email.com',
    'password.label': 'Password',
    'password.placeholder': '••••••••',
    'password.requirement': 'Password must be at least 6 characters long',
    'signup.button': 'Create Account',
    'signup.creating': 'Creating account...',
    'signup.emailSent': 'Confirmation Email Sent',
    'signup.demoActive': 'Demo Mode Active',
    
    // Search page translations
    'search.placeholder': 'Search by location or property name',
    'search.showFilters': 'Show Filters',
    'search.hideFilters': 'Hide Filters',
    'search.propertyType': 'Property Type',
    'search.anyPropertyType': 'Any property type',
    'search.villa': 'Villa',
    'search.apartment': 'Apartment',
    'search.studio': 'Studio',
    'search.duplex': 'Duplex',
    'search.traditionalHouse': 'Traditional House',
    'search.loft': 'Loft',
    'search.chalet': 'Chalet',
    'search.city': 'City',
    'search.anyCity': 'Any city',
    'search.priceRange': 'Price Range (DZD)',
    'search.minimumBedrooms': 'Minimum Bedrooms',
    'search.any': 'Any',
    'search.features': 'Features',
    'search.parking': 'Parking',
    'search.furnished': 'Furnished',
    'search.pool': 'Pool',
    'search.garden': 'Garden',
    'search.security': 'Security',
    'search.petFriendly': 'Pet Friendly',
    'search.propertiesFound': 'Properties Found',
    'search.noPropertiesFound': 'No properties found',
    'search.adjustSearchCriteria': 'Try adjusting your search criteria to find more properties.',
    'search.resetFilters': 'Reset Filters',
    'role.placeholder': 'Select your role',
    'otp.verifying': 'Verifying...',
    
    // Hero section translations
    'search.location': 'Location, property name, or keyword',
    'search.search': 'Search',
    'hero.browse': 'Browse Properties',
  }
};

const LanguageContext = createContext<LanguageContextType>({
  language: 'fr',
  setLanguage: () => {},
  t: (key: string) => key,
  dir: 'ltr',
});

export const useLanguage = () => useContext(LanguageContext);

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguageState] = useState<'ar' | 'fr' | 'en'>(() => {
    // Try to get saved language preference from localStorage
    const savedLang = localStorage.getItem('language');
    return (savedLang === 'ar' ? 'ar' : savedLang === 'en' ? 'en' : 'fr');
  });

  const setLanguage = (lang: 'ar' | 'fr' | 'en') => {
    setLanguageState(lang);
    localStorage.setItem('language', lang);
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = lang;
  };

  useEffect(() => {
    // Set initial direction based on language
    document.documentElement.dir = language === 'ar' ? 'rtl' : 'ltr';
    document.documentElement.lang = language;
  }, [language]);

  const t = (key: string): string => {
    return translations[language]?.[key as keyof typeof translations.fr] || key;
  };

  return (
    <LanguageContext.Provider value={{ 
      language, 
      setLanguage, 
      t,
      dir: language === 'ar' ? 'rtl' : 'ltr'
    }}>
      {children}
    </LanguageContext.Provider>
  );
};
